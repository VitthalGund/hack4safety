{% extends "report_base.html" %} {% block content %}
<h2>Executive Summary: {{ district }}</h2>
<div class="kpi-container">
  <div class="kpi-item">
    <div class="kpi-value">{{ kpis.conviction_rate | round(1) }}%</div>
    <div class="kpi-label">District Conviction Rate</div>
  </div>
  <div class="kpi-item">
    <div class="kpi-value">{{ kpis.avg_lifecycle_days | round(0) }}</div>
    <div class="kpi-label">Avg. Case Lifecycle (Days)</div>
  </div>
  <div class="kpi-item">
    <div class="kpi-value">{{ kpis.avg_investigation_days | round(0) }}</div>
    <div class="kpi-label">Avg. Investigation (Days)</div>
  </div>
</div>

<h2>Tactical Performance Hotspots</h2>
<p>Top 5 Performing Investigating Officers (District-Wide Data)</p>
<table>
  <thead>
    <tr>
      <th>Rank</th>
      <th>Officer Name</th>
      <th>Officer Rank</th>
      <th>Total Cases</th>
      <th>Conviction Rate</th>
    </tr>
  </thead>
  <tbody>
    {% for item in rankings %}
    <tr>
      <td>{{ loop.index }}</td>
      <td>{{ item.officer_name }}</td>
      <td>{{ item.rank }}</td>
      <td>{{ item.total_cases }}</td>
      <td>{{ (item.conviction_rate * 100) | round(1) }}%</td>
    </tr>
    {% else %}
    <tr>
      <td colspan="5" style="text-align: center">No ranking data available.</td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<h2>AI-Driven Gaps & Correction</h2>
<p>Top reasons for acquittals in {{ district }}.</p>
<div class="chart">
  {% if acquittal_chart_base64 %}
  <img
    src="data:image/png;base64,{{ acquittal_chart_base64 }}"
    alt="Acquittal Reasons Chart"
  />
  {% else %}
  <p>No acquittal data available to generate chart.</p>
  {% endif %}
</div>
{% endblock %}
